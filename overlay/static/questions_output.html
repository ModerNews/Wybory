<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title>Wybór pytań</title>

        <script
        src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
        crossorigin="anonymous"></script>

        <style>
            button {
            font-size: 1.2em;
            }
        </style>
    </head>
    <body>
        <div id='question-container'>

        </div>
    </body>
    <script>
        let ws

        function createWebsocket() {
            ws = new WebSocket("ws://" + location.hostname + ":" + location.port + "/websocket");
            ws.onopen = function(evt) { onOpen(evt) };
            ws.onclose = function(evt) { onClose(evt) };
            ws.onmessage = function(evt) { onMessage(evt) };
            ws.onerror = function(evt) { onError(evt) };
            
            function onOpen(evt)
            {

            }

            function onClose(evt)
            {
            console.log("Trying to reconnect...");
            setTimeout(createWebsocket, 1000);
            }

            function onMessage(evt)
            {
                let questions = document.getElementById("question-container")
                console.log('receiving')
                let data = JSON.parse(evt.data);
                if(data.event === 'question-add') {
                    console.log('question-add')
                    var line = document.createElement("p")
                    line.innerHTML = evt.data.content
                    questions.appendChild(line)
                }
            }

            function onError(evt)
            {
                console.error("socket error");
            }
        }

        createWebsocket()
    </script>
</html>